define([],function(){function i(t){return document.getElementById(t)}class e{constructor(t,s){this.s=t.selectors||{},this.t=t.i18n||{},this.ds=s||{},this.spinner=i(this.s.spinner),this.status=i(this.s.status),this.retry=i(this.s.retry),this.busy=!1,this.retried=!1}init(){this.ds.verifyUrl&&this.retry&&this.spinner&&this.status&&(this.verifyOnce(),this.retry.addEventListener("click",t=>{t.preventDefault(),this.retried||this.busy||(this.retried=!0,this.verifyOnce())}))}setBusy(t){var s;this.busy=!!t,this.spinner&&(this.spinner.style.display=t?"":"none"),this.status&&this.t.verifying&&(this.status.textContent=this.t.verifying),s=this.retry,t=t||this.retried,s&&(t?(s.setAttribute("disabled","disabled"),s.classList.add("disabled")):(s.removeAttribute("disabled"),s.classList.remove("disabled")))}async verifyOnce(){this.setBusy(!0);try{var t=await(await fetch(this.ds.verifyUrl,{credentials:"same-origin"})).json();if(t&&t.paid)return void window.location.assign(this.ds.successUrl)}catch{}this.setBusy(!1),this.retried&&window.location.assign(this.ds.coursesUrl)}}return{init:function(t,s){var i=window.ifthenpay||{};new e({selectors:t,i18n:s},i).init()}}});