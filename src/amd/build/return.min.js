define([],function(){function i(s){return document.getElementById(s)}class e{constructor(s,t){this.s=s.selectors||{},this.t=s.i18n||{},this.ds=t||{},this.spinner=i(this.s.spinner),this.status=i(this.s.status),this.retry=i(this.s.retry),this.busy=!1,this.retried=!1}init(){this.ds.verifyUrl&&this.retry&&this.spinner&&this.status&&(this.verifyOnce(),this.retry.addEventListener("click",s=>{s.preventDefault(),this.retried||this.busy||(this.retried=!0,this.verifyOnce())}))}setBusy(s){var t;this.busy=!!s,this.spinner&&(this.spinner.style.display=s?"":"none"),this.status&&this.t.verifying&&(this.status.textContent=this.t.verifying),t=this.retry,s=s||this.retried,t&&(s?(t.setAttribute("disabled","disabled"),t.classList.add("disabled")):(t.removeAttribute("disabled"),t.classList.remove("disabled")))}async verifyOnce(){this.setBusy(!0);try{var s=await(await fetch(this.ds.verifyUrl,{credentials:"same-origin"})).json();if(s&&s.paid)return void window.location.assign(this.ds.successUrl)}catch(s){console.error(s)}this.setBusy(!1),this.retried&&window.location.assign(this.ds.coursesUrl)}}return{init:function(s,t){var i=window.ifthenpay||{};new e({selectors:s,i18n:t},i).init()}}});